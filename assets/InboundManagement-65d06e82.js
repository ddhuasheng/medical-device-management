import{r as i,q as H,G as Y,b as u,v as re,d as r,e as y,g as I,f as t,w as n,x as ie,i as v,k as m,F as C,h as N,t as S,l as M,E as P,B as j}from"./index-8e7c3932.js";import{_ as me}from"./plugin-vueexport-helper-c27b6911.js";const pe={class:"inbound-management"},ce={class:"operation-bar"},be={class:"pagination-container"},ge={class:"dialog-footer"},ve={__name:"InboundManagement",setup(fe){const F=[{value:"completed",label:"已出库"},{value:"pending",label:"待审核"},{value:"canceled",label:"已作废"},{value:"rejected",label:"驳回"}],O={completed:"已出库",pending:"待审核",canceled:"已作废",rejected:"驳回"},$={completed:"success",pending:"warning",canceled:"info",rejected:"danger"},B=[{id:1,name:"主仓库"},{id:2,name:"备用仓库"}],E=i([{number:"PC-2023001",device:"血压计"},{number:"PC-2023002",device:"血糖仪"}]),A=i([{id:1,name:"张三"},{id:2,name:"李四"}]),c=H({keyword:"",status:""}),f=i([{id:1,contractNumber:"PC-2023001",deviceName:"血压计",quantity:50,warehouseId:1,warehouseName:"主仓库",location:"A-1-1",responsiblePerson:1,inboundTime:"2023-08-01 14:30:00",status:"completed"}]),x=i(1),T=i(10),L=i(1),q=i(!1),g=i(!1),V=i(""),_=i(),a=H({id:null,contractNumber:"",deviceName:"",quantity:1,warehouseId:null,location:"",responsiblePerson:null,inboundTime:Y().format("YYYY-MM-DD HH:mm:ss"),status:"pending"}),R={contractNumber:[{required:!0,message:"请选择采购合同",trigger:"change"}],deviceName:[{required:!0,message:"请输入设备名称",trigger:"blur"},{min:2,max:50,message:"长度在2-50个字符",trigger:"blur"}],quantity:[{required:!0,message:"请输入数量",trigger:"blur"},{type:"number",min:1,message:"至少1个",trigger:"blur"}],warehouseId:[{required:!0,message:"请选择仓库",trigger:"change"}],location:[{required:!0,message:"请输入设备位置",trigger:"blur"},{pattern:/^[A-Z]-\d+-\d+$/,message:"位置格式不正确（如：B-1-2）",trigger:"blur"}],responsiblePerson:[{required:!0,message:"请选择责任人",trigger:"change"}],inboundTime:[{required:!0,message:"请选择入库时间",trigger:"change"}]},G=o=>Y(o).format("YYYY-MM-DD HH:mm"),k=()=>{q.value=!0,setTimeout(()=>{q.value=!1},500)},Z=()=>{c.keyword="",c.status="",k()},J=()=>{V.value="新建入库",g.value=!0},K=o=>{V.value="编辑入库",Object.assign(a,o),g.value=!0},Q=async()=>{_.value&&await _.value.validate(o=>{if(o){const l=B.find(b=>b.id===a.warehouseId),d={...a,warehouseName:l==null?void 0:l.name,id:a.id||f.value.length+1};if(a.id){const b=f.value.findIndex(s=>s.id===a.id);f.value.splice(b,1,d)}else f.value.unshift(d);P.success(`${V.value}成功`),g.value=!1,D()}})},W=o=>{j.confirm("确认审核通过该入库单？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o.status="completed",P.success("审核通过成功")})},X=o=>{j.confirm("确认作废该入库单？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{o.status="canceled",P.success("已作废")})},D=()=>{_.value&&_.value.resetFields(),Object.assign(a,{id:null,contractNumber:"",deviceName:"",quantity:1,warehouseId:null,location:"",responsiblePerson:null,inboundTime:Y().format("YYYY-MM-DD HH:mm:ss"),status:"pending"})},ee=o=>{T.value=o,k()},le=o=>{x.value=o,k()};return(o,l)=>{const d=u("el-button"),b=u("el-input"),s=u("el-form-item"),w=u("el-option"),h=u("el-select"),U=u("el-form"),p=u("el-table-column"),te=u("el-tag"),ne=u("el-table"),ae=u("el-pagination"),oe=u("el-input-number"),ue=u("el-date-picker"),se=u("el-dialog"),de=re("loading");return r(),y("div",pe,[I("div",ce,[t(d,{type:"primary",onClick:J},{default:n(()=>l[13]||(l[13]=[m("新建入库")])),_:1}),t(U,{inline:!0,model:c,class:"search-form"},{default:n(()=>[t(s,null,{default:n(()=>[t(b,{modelValue:c.keyword,"onUpdate:modelValue":l[0]||(l[0]=e=>c.keyword=e),placeholder:"合同编号/设备名称",clearable:""},null,8,["modelValue"])]),_:1}),t(s,null,{default:n(()=>[t(h,{modelValue:c.status,"onUpdate:modelValue":l[1]||(l[1]=e=>c.status=e),placeholder:"选择状态",clearable:""},{default:n(()=>[(r(),y(C,null,N(F,e=>t(w,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(s,null,{default:n(()=>[t(d,{type:"primary",onClick:k},{default:n(()=>l[14]||(l[14]=[m("搜索")])),_:1}),t(d,{onClick:Z},{default:n(()=>l[15]||(l[15]=[m("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),ie((r(),v(ne,{data:f.value,style:{width:"100%"}},{default:n(()=>[t(p,{prop:"contractNumber",label:"采购合同",width:"180"}),t(p,{prop:"deviceName",label:"设备名称",width:"150"}),t(p,{prop:"quantity",label:"数量",width:"100"}),t(p,{prop:"warehouseName",label:"仓库名称",width:"150"}),t(p,{prop:"location",label:"设备位置",width:"120"}),t(p,{prop:"responsiblePerson",label:"责任人",width:"120"}),t(p,{prop:"inboundTime",label:"入库时间",width:"150"},{default:n(({row:e})=>[m(S(G(e.inboundTime)),1)]),_:1}),t(p,{label:"状态",width:"120"},{default:n(({row:e})=>[t(te,{type:$[e.status]},{default:n(()=>[m(S(O[e.status]),1)]),_:2},1032,["type"])]),_:1}),t(p,{label:"操作",width:"180",fixed:"right"},{default:n(({row:e})=>[e.status==="pending"?(r(),v(d,{key:0,type:"primary",link:"",onClick:z=>K(e)},{default:n(()=>l[16]||(l[16]=[m(" 编辑 ")])),_:2},1032,["onClick"])):M("",!0),e.status==="pending"?(r(),v(d,{key:1,type:"danger",link:"",onClick:z=>X(e)},{default:n(()=>l[17]||(l[17]=[m(" 作废 ")])),_:2},1032,["onClick"])):M("",!0),e.status==="pending"?(r(),v(d,{key:2,type:"success",link:"",onClick:z=>W(e)},{default:n(()=>l[18]||(l[18]=[m(" 审核通过 ")])),_:2},1032,["onClick"])):M("",!0)]),_:1})]),_:1},8,["data"])),[[de,q.value]]),I("div",be,[t(ae,{"current-page":x.value,"onUpdate:currentPage":l[2]||(l[2]=e=>x.value=e),"page-size":T.value,"onUpdate:pageSize":l[3]||(l[3]=e=>T.value=e),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:L.value,onSizeChange:ee,onCurrentChange:le},null,8,["current-page","page-size","total"])]),t(se,{title:V.value,modelValue:g.value,"onUpdate:modelValue":l[12]||(l[12]=e=>g.value=e),width:"600px",onClose:D},{footer:n(()=>[I("span",ge,[t(d,{onClick:l[11]||(l[11]=e=>g.value=!1)},{default:n(()=>l[19]||(l[19]=[m("取消")])),_:1}),t(d,{type:"primary",onClick:Q},{default:n(()=>l[20]||(l[20]=[m("确定")])),_:1})])]),default:n(()=>[t(U,{ref_key:"formRef",ref:_,model:a,rules:R,"label-width":"100px"},{default:n(()=>[t(s,{label:"采购合同",prop:"contractNumber"},{default:n(()=>[t(h,{modelValue:a.contractNumber,"onUpdate:modelValue":l[4]||(l[4]=e=>a.contractNumber=e),placeholder:"请选择采购合同",filterable:"",style:{width:"100%"}},{default:n(()=>[(r(!0),y(C,null,N(E.value,e=>(r(),v(w,{key:e.number,label:e.number,value:e.number},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"设备名称",prop:"deviceName"},{default:n(()=>[t(b,{modelValue:a.deviceName,"onUpdate:modelValue":l[5]||(l[5]=e=>a.deviceName=e),placeholder:"请输入设备名称"},null,8,["modelValue"])]),_:1}),t(s,{label:"数量",prop:"quantity"},{default:n(()=>[t(oe,{modelValue:a.quantity,"onUpdate:modelValue":l[6]||(l[6]=e=>a.quantity=e),min:1,precision:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(s,{label:"仓库",prop:"warehouseId"},{default:n(()=>[t(h,{modelValue:a.warehouseId,"onUpdate:modelValue":l[7]||(l[7]=e=>a.warehouseId=e),placeholder:"请选择仓库",style:{width:"100%"}},{default:n(()=>[(r(),y(C,null,N(B,e=>t(w,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"设备位置",prop:"location"},{default:n(()=>[t(b,{modelValue:a.location,"onUpdate:modelValue":l[8]||(l[8]=e=>a.location=e),placeholder:"格式：B-1-2"},null,8,["modelValue"])]),_:1}),t(s,{label:"责任人",prop:"responsiblePerson"},{default:n(()=>[t(h,{modelValue:a.responsiblePerson,"onUpdate:modelValue":l[9]||(l[9]=e=>a.responsiblePerson=e),placeholder:"请选择责任人",style:{width:"100%"}},{default:n(()=>[(r(!0),y(C,null,N(A.value,e=>(r(),v(w,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(s,{label:"入库时间",prop:"inboundTime"},{default:n(()=>[t(ue,{modelValue:a.inboundTime,"onUpdate:modelValue":l[10]||(l[10]=e=>a.inboundTime=e),type:"datetime",placeholder:"选择日期时间","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},Ve=me(ve,[["__scopeId","data-v-9010b3d5"]]);export{Ve as default};
