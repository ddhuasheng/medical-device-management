import{_ as J}from"./plugin-vueexport-helper-c27b6911.js";import{r as f,q as b,b as n,d as u,e as g,f as t,w as a,g as x,k as d,t as h,F as y,h as k,E as q,B as K,i as U}from"./index-8e7c3932.js";const P={class:"user-management-container"},Q={class:"card-header"},W={class:"dialog-footer"},X={__name:"UserManagement",setup(Y){const w=f(null),i=f([{userNo:"U1001",username:"admin",department:"信息科",roles:["系统管理员"],status:1}]),m=f(!1),V=f("新增用户"),v=f(!1),o=b({username:"",password:"",department:"",roles:[],status:1}),F=b([{value:"信息科",label:"信息科"},{value:"财务科",label:"财务科"},{value:"设备科",label:"设备科"}]),D=b([{value:"系统管理员",label:"系统管理员"},{value:"普通用户",label:"普通用户"},{value:"设备管理员",label:"设备管理员"}]),O=b({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:16,message:"长度在 3 到 16 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:18,message:"长度在 6 到 18 个字符",trigger:"blur"}],department:[{required:!0,message:"请选择所属部门",trigger:"change"}],roles:[{required:!0,message:"请选择角色",trigger:"change"}]}),T=()=>{v.value=!1,V.value="新增用户",j(),m.value=!0},I=s=>{v.value=!0,V.value="编辑用户",Object.assign(o,s),m.value=!0},R=async()=>{try{if(await w.value.validate(),v.value){const s=i.value.findIndex(e=>e.userNo===o.userNo);s!==-1&&i.value.splice(s,1,{...o})}else i.value.push({...o,userNo:$()});q.success(v.value?"修改成功":"新增成功"),m.value=!1}catch(s){console.log("表单验证失败",s)}},$=()=>"U"+Math.floor(1e3+Math.random()*9e3),j=()=>{var s;(s=w.value)==null||s.resetFields(),Object.keys(o).forEach(e=>{e!=="status"&&(o[e]="")}),o.status=1},z=s=>{K.confirm("确定删除该用户吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=i.value.findIndex(r=>r.userNo===s.userNo);e!==-1&&(i.value.splice(e,1),q.success("删除成功"))})};return(s,e)=>{const r=n("el-button"),p=n("el-table-column"),N=n("el-tag"),C=n("el-switch"),A=n("el-table"),L=n("el-card"),B=n("el-input"),c=n("el-form-item"),M=n("el-option"),E=n("el-select"),S=n("el-form"),G=n("el-dialog");return u(),g("div",P,[t(L,{class:"box-card"},{header:a(()=>[x("div",Q,[e[8]||(e[8]=x("span",null,"用户管理",-1)),t(r,{type:"primary",onClick:T},{default:a(()=>e[7]||(e[7]=[d("新增用户")])),_:1})])]),default:a(()=>[t(A,{data:i.value,border:"",style:{width:"100%"}},{default:a(()=>[t(p,{prop:"userNo",label:"用户编号",width:"120"}),t(p,{prop:"username",label:"用户名",width:"150"}),t(p,{prop:"department",label:"所属部门",width:"180"},{default:a(l=>[t(N,null,{default:a(()=>[d(h(l.row.department),1)]),_:2},1024)]),_:1}),t(p,{prop:"roles",label:"角色",width:"200"},{default:a(l=>[(u(!0),g(y,null,k(l.row.roles,(_,H)=>(u(),U(N,{key:H,type:"info",class:"role-tag"},{default:a(()=>[d(h(_),1)]),_:2},1024))),128))]),_:1}),t(p,{prop:"status",label:"状态",width:"100"},{default:a(l=>[t(C,{modelValue:l.row.status,"onUpdate:modelValue":_=>l.row.status=_,"active-text":"启用","inactive-text":"停用","active-value":1,"inactive-value":0},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),t(p,{label:"操作",width:"180"},{default:a(l=>[t(r,{size:"small",onClick:_=>I(l.row)},{default:a(()=>e[9]||(e[9]=[d("编辑")])),_:2},1032,["onClick"]),t(r,{size:"small",type:"danger",onClick:_=>z(l.row)},{default:a(()=>e[10]||(e[10]=[d(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),t(G,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=l=>m.value=l),title:V.value},{footer:a(()=>[x("span",W,[t(r,{onClick:e[5]||(e[5]=l=>m.value=!1)},{default:a(()=>e[11]||(e[11]=[d("取消")])),_:1}),t(r,{type:"primary",onClick:R},{default:a(()=>e[12]||(e[12]=[d("确认")])),_:1})])]),default:a(()=>[t(S,{model:o,rules:O,ref_key:"formRef",ref:w,"label-width":"100px"},{default:a(()=>[t(c,{label:"用户名",prop:"username"},{default:a(()=>[t(B,{modelValue:o.username,"onUpdate:modelValue":e[0]||(e[0]=l=>o.username=l)},null,8,["modelValue"])]),_:1}),t(c,{label:"密码",prop:"password"},{default:a(()=>[t(B,{type:"password",modelValue:o.password,"onUpdate:modelValue":e[1]||(e[1]=l=>o.password=l),"show-password":""},null,8,["modelValue"])]),_:1}),t(c,{label:"所属部门",prop:"department"},{default:a(()=>[t(E,{modelValue:o.department,"onUpdate:modelValue":e[2]||(e[2]=l=>o.department=l),placeholder:"请选择部门",filterable:""},{default:a(()=>[(u(!0),g(y,null,k(F,l=>(u(),U(M,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"角色",prop:"roles"},{default:a(()=>[t(E,{modelValue:o.roles,"onUpdate:modelValue":e[3]||(e[3]=l=>o.roles=l),multiple:"",placeholder:"请选择角色"},{default:a(()=>[(u(!0),g(y,null,k(D,l=>(u(),U(M,{key:l.value,label:l.label,value:l.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(c,{label:"状态",prop:"status"},{default:a(()=>[t(C,{modelValue:o.status,"onUpdate:modelValue":e[4]||(e[4]=l=>o.status=l),"active-text":"启用","inactive-text":"停用","active-value":1,"inactive-value":0},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}},le=J(X,[["__scopeId","data-v-cc9ea2d3"]]);export{le as default};
