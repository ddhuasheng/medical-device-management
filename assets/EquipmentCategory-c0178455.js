import{q as U,r as f,c as le,o as ae,b as s,v as oe,d as V,e as E,f as t,w as l,g as S,E as _,B as M,F as re,h as ne,k as c,j as R,x as de,i as $,t as se,l as ie,y as ue,z as ce}from"./index-8e7c3932.js";import{_ as pe}from"./plugin-vueexport-helper-c27b6911.js";const me={class:"equipment-category-container"},ge={class:"table-toolbar"},fe={class:"dialog-footer"},ye={__name:"EquipmentCategory",setup(_e){const O=[{value:"active",label:"启用"},{value:"inactive",label:"禁用"}],p=U({categoryName:"",status:""}),j=()=>{p.categoryName="",p.status="",w()},w=()=>{b()},N=f(!1),k=f([]),v=f([]),b=()=>{N.value=!0,setTimeout(()=>{let e=[...[{id:1,categoryCode:"FL001",categoryName:"影像设备",description:"包括CT、MRI等影像类医疗设备",sort:1,status:"active",createTime:"2023-06-15 10:30:00",children:[{id:4,parentId:1,categoryCode:"FL001001",categoryName:"CT设备",description:"CT扫描仪等设备",sort:1,status:"active",createTime:"2023-06-15 11:30:00"},{id:5,parentId:1,categoryCode:"FL001002",categoryName:"MRI设备",description:"磁共振成像设备",sort:2,status:"active",createTime:"2023-06-15 11:35:00"}]},{id:2,categoryCode:"FL002",categoryName:"生命支持设备",description:"包括呼吸机、监护仪等生命支持类医疗设备",sort:2,status:"active",createTime:"2023-06-20 14:20:00",children:[{id:6,parentId:2,categoryCode:"FL002001",categoryName:"呼吸机",description:"各类呼吸机设备",sort:1,status:"active",createTime:"2023-06-20 15:20:00"},{id:7,parentId:2,categoryCode:"FL002002",categoryName:"监护仪",description:"各类监护仪设备",sort:2,status:"active",createTime:"2023-06-20 15:25:00"}]},{id:3,categoryCode:"FL003",categoryName:"诊断设备",description:"包括心电图机、超声波仪等诊断类医疗设备",sort:3,status:"inactive",createTime:"2023-07-05 09:15:00",children:[{id:8,parentId:3,categoryCode:"FL003001",categoryName:"心电图机",description:"各类心电图检查设备",sort:1,status:"inactive",createTime:"2023-07-05 10:15:00"},{id:9,parentId:3,categoryCode:"FL003002",categoryName:"超声波仪",description:"各类超声波检查设备",sort:2,status:"inactive",createTime:"2023-07-05 10:20:00"}]}]];if(p.categoryName){const n=d=>d.filter(u=>{const g=u.categoryName.includes(p.categoryName);if(u.children&&u.children.length){const i=n(u.children);return u.children=i,g||i.length>0}return g});e=n(e)}if(p.status){const n=d=>d.filter(u=>{const g=u.status===p.status;if(u.children&&u.children.length){const i=n(u.children);return u.children=i,g||i.length>0}return g});e=n(e)}k.value=e,N.value=!1},500)},z=r=>{v.value=r},y=f(!1),h=f("add"),T=f(null),C=f(null),o=U({id:null,parentId:null,categoryCode:"",categoryName:"",description:"",sort:0,status:"active"}),A={categoryCode:[{required:!0,message:"请输入分类编码",trigger:"blur"}],categoryName:[{required:!0,message:"请输入分类名称",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}]},P=le(()=>{const r=e=>e.map(n=>{const d={id:n.id,categoryName:n.categoryName,categoryCode:n.categoryCode};return n.children&&n.children.length&&(d.children=r(n.children)),d});return r(k.value)}),x=r=>{h.value="add",I(),r?(C.value=r,o.parentId=r.id):(C.value=null,o.parentId=null),y.value=!0},G=r=>{h.value="edit",I(),Object.assign(o,r),C.value=null,y.value=!0},I=()=>{o.id=null,o.parentId=null,o.categoryCode="",o.categoryName="",o.description="",o.sort=0,o.status="active"},H=()=>{T.value.validate(r=>{r&&(_.success(h.value==="add"?"新增成功":"编辑成功"),y.value=!1,b())})},J=r=>{if(r.children&&r.children.length){_.warning("该分类下有子分类，不能删除");return}M.confirm("确定要删除该分类吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{_.success("删除成功"),b()}).catch(()=>{})},K=()=>{if(v.value.length===0){_.warning("请选择要删除的分类");return}if(v.value.some(e=>e.children&&e.children.length)){_.warning("选中的分类中有包含子分类的项，不能删除");return}M.confirm(`确定要删除选中的 ${v.value.length} 个分类吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{_.success("批量删除成功"),b()}).catch(()=>{})};return ae(()=>{b()}),(r,e)=>{const n=s("el-input"),d=s("el-form-item"),u=s("el-option"),g=s("el-select"),i=s("el-button"),F=s("el-form"),B=s("el-card"),D=s("el-icon"),m=s("el-table-column"),Q=s("el-tag"),W=s("el-table"),X=s("el-cascader"),Y=s("el-input-number"),L=s("el-radio"),Z=s("el-radio-group"),ee=s("el-dialog"),te=oe("loading");return V(),E("div",me,[t(B,{class:"search-card"},{default:l(()=>[t(F,{inline:!0,model:p,class:"search-form"},{default:l(()=>[t(d,{label:"分类名称"},{default:l(()=>[t(n,{modelValue:p.categoryName,"onUpdate:modelValue":e[0]||(e[0]=a=>p.categoryName=a),placeholder:"请输入分类名称",clearable:""},null,8,["modelValue"])]),_:1}),t(d,{label:"状态"},{default:l(()=>[t(g,{modelValue:p.status,"onUpdate:modelValue":e[1]||(e[1]=a=>p.status=a),placeholder:"请选择状态",clearable:""},{default:l(()=>[(V(),E(re,null,ne(O,a=>t(u,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(d,null,{default:l(()=>[t(i,{type:"primary",onClick:w},{default:l(()=>e[10]||(e[10]=[c("搜索")])),_:1}),t(i,{onClick:j},{default:l(()=>e[11]||(e[11]=[c("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),S("div",ge,[t(i,{type:"primary",onClick:x},{default:l(()=>[t(D,null,{default:l(()=>[t(R(ue))]),_:1}),e[12]||(e[12]=c("新增分类 "))]),_:1}),t(i,{type:"danger",disabled:!v.value.length,onClick:K},{default:l(()=>[t(D,null,{default:l(()=>[t(R(ce))]),_:1}),e[13]||(e[13]=c("批量删除 "))]),_:1},8,["disabled"])]),t(B,{class:"table-card"},{default:l(()=>[de((V(),$(W,{data:k.value,border:"","row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"},style:{width:"100%"},onSelectionChange:z},{default:l(()=>[t(m,{type:"selection",width:"55"}),t(m,{prop:"categoryCode",label:"分类编码",width:"120"}),t(m,{prop:"categoryName",label:"分类名称",width:"180"}),t(m,{prop:"description",label:"描述","show-overflow-tooltip":""}),t(m,{prop:"sort",label:"排序",width:"80"}),t(m,{prop:"status",label:"状态",width:"100"},{default:l(a=>[t(Q,{type:a.row.status==="active"?"success":"info"},{default:l(()=>[c(se(a.row.status==="active"?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(m,{prop:"createTime",label:"创建时间",width:"150"}),t(m,{label:"操作",width:"200"},{default:l(a=>[a.row.status==="active"?(V(),$(i,{key:0,type:"primary",link:"",onClick:q=>x(a.row)},{default:l(()=>e[14]||(e[14]=[c(" 添加子分类 ")])),_:2},1032,["onClick"])):ie("",!0),t(i,{type:"primary",link:"",onClick:q=>G(a.row)},{default:l(()=>e[15]||(e[15]=[c(" 编辑 ")])),_:2},1032,["onClick"]),t(i,{type:"danger",link:"",onClick:q=>J(a.row)},{default:l(()=>e[16]||(e[16]=[c(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[te,N.value]])]),_:1}),t(ee,{title:h.value==="add"?C.value?"新增子分类":"新增分类":"编辑分类",modelValue:y.value,"onUpdate:modelValue":e[9]||(e[9]=a=>y.value=a),width:"500px"},{footer:l(()=>[S("span",fe,[t(i,{onClick:e[8]||(e[8]=a=>y.value=!1)},{default:l(()=>e[19]||(e[19]=[c("取消")])),_:1}),t(i,{type:"primary",onClick:H},{default:l(()=>e[20]||(e[20]=[c("确定")])),_:1})])]),default:l(()=>[t(F,{ref_key:"formRef",ref:T,model:o,rules:A,"label-width":"100px"},{default:l(()=>[t(d,{label:"上级分类"},{default:l(()=>[t(X,{modelValue:o.parentId,"onUpdate:modelValue":e[2]||(e[2]=a=>o.parentId=a),options:P.value,props:{checkStrictly:!0,label:"categoryName",value:"id",emitPath:!1},clearable:"",placeholder:"请选择上级分类",disabled:!!C.value},null,8,["modelValue","options","disabled"])]),_:1}),t(d,{label:"分类编码",prop:"categoryCode"},{default:l(()=>[t(n,{modelValue:o.categoryCode,"onUpdate:modelValue":e[3]||(e[3]=a=>o.categoryCode=a),placeholder:"请输入分类编码",disabled:h.value==="edit"},null,8,["modelValue","disabled"])]),_:1}),t(d,{label:"分类名称",prop:"categoryName"},{default:l(()=>[t(n,{modelValue:o.categoryName,"onUpdate:modelValue":e[4]||(e[4]=a=>o.categoryName=a),placeholder:"请输入分类名称"},null,8,["modelValue"])]),_:1}),t(d,{label:"描述",prop:"description"},{default:l(()=>[t(n,{modelValue:o.description,"onUpdate:modelValue":e[5]||(e[5]=a=>o.description=a),type:"textarea",placeholder:"请输入描述",rows:3},null,8,["modelValue"])]),_:1}),t(d,{label:"排序",prop:"sort"},{default:l(()=>[t(Y,{modelValue:o.sort,"onUpdate:modelValue":e[6]||(e[6]=a=>o.sort=a),min:0,max:999,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(d,{label:"状态",prop:"status"},{default:l(()=>[t(Z,{modelValue:o.status,"onUpdate:modelValue":e[7]||(e[7]=a=>o.status=a)},{default:l(()=>[t(L,{label:"active"},{default:l(()=>e[17]||(e[17]=[c("启用")])),_:1}),t(L,{label:"inactive"},{default:l(()=>e[18]||(e[18]=[c("禁用")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},he=pe(ye,[["__scopeId","data-v-a1178ef3"]]);export{he as default};
