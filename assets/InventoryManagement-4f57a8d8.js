import{_ as J}from"./_plugin-vue_export-helper-c27b6911.js";import{q as M,r as d,b as u,v as K,d as b,e as x,g as y,f as t,w as a,x as W,i as X,k as p,F as Q,h as S,t as Y,D as ee,B as le,E as C}from"./index-7b3de2f1.js";const te={class:"inventory-management"},ae={class:"operation-bar"},ne={class:"pagination-container"},oe={class:"dialog-footer"},ue={__name:"InventoryManagement",setup(ie){const w=[{id:1,name:"主仓库"},{id:2,name:"备用仓库"}],s=M({keyword:"",warehouseId:null}),m=d([{id:1,modelNumber:"MDM-001",deviceName:"血压计",quantity:50,minQuantity:10,warehouseId:1,warehouseName:"主仓库",location:"A-1-1"},{id:2,modelNumber:"MDM-002",deviceName:"血糖仪",quantity:30,minQuantity:5,warehouseId:2,warehouseName:"备用仓库",location:"B-1-2"}]),V=d(1),N=d(10),D=d(0),h=d(!1),c=d(!1),k=d(""),f=d(),n=M({id:null,modelNumber:"",deviceName:"",quantity:0,minQuantity:0,warehouseId:null,location:""}),F={modelNumber:[{required:!0,message:"请输入设备型号",trigger:"blur"},{min:3,max:20,message:"长度在 3 到 20 个字符",trigger:"blur"}],deviceName:[{required:!0,message:"请输入设备名称",trigger:"blur"},{min:2,max:50,message:"长度在 2 到 50 个字符",trigger:"blur"}],quantity:[{required:!0,message:"请输入设备数量",trigger:"blur"},{type:"number",min:0,message:"数量不能小于0",trigger:"blur"}],minQuantity:[{required:!0,message:"请输入最小库存数量",trigger:"blur"},{type:"number",min:0,message:"数量不能小于0",trigger:"blur"}],warehouseId:[{required:!0,message:"请选择所在仓库",trigger:"change"}],location:[{required:!0,message:"请输入设备位置",trigger:"blur"},{pattern:/^[A-Z]-\d+-\d+$/,message:"位置格式不正确（如：B-1-2）",trigger:"blur"}]},_=()=>{h.value=!0,setTimeout(()=>{h.value=!1},500)},E=()=>{s.keyword="",s.warehouseId=null,_()},T=()=>{k.value="新增库存",c.value=!0},$=i=>{k.value="编辑库存",Object.assign(n,i),c.value=!0},j=i=>{le.confirm("确认要删除该库存记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=m.value.findIndex(o=>o.id===i.id);e!==-1&&m.value.splice(e,1),C.success("删除成功")}).catch(()=>{})},A=async()=>{f.value&&await f.value.validate(i=>{if(i){const e=w.find(o=>o.id===n.warehouseId);if(n.id){const o=m.value.findIndex(g=>g.id===n.id);o!==-1&&(m.value[o]={...n,warehouseName:e==null?void 0:e.name}),C.success("编辑成功")}else{const o={...n,id:m.value.length+1,warehouseName:e==null?void 0:e.name};m.value.push(o),C.success("新增成功")}c.value=!1,q()}})},q=()=>{f.value&&f.value.resetFields(),Object.assign(n,{id:null,modelNumber:"",deviceName:"",quantity:0,minQuantity:0,warehouseId:null,location:""})},O=i=>{N.value=i,_()},L=i=>{V.value=i,_()};return(i,e)=>{const o=u("el-button"),g=u("el-input"),r=u("el-form-item"),I=u("el-option"),B=u("el-select"),U=u("el-form"),v=u("el-table-column"),P=u("el-table"),R=u("el-pagination"),z=u("el-input-number"),Z=u("el-dialog"),G=K("loading");return b(),x("div",te,[y("div",ae,[t(o,{type:"primary",onClick:T},{default:a(()=>e[12]||(e[12]=[p("新增库存")])),_:1}),t(U,{inline:!0,model:s,class:"search-form"},{default:a(()=>[t(r,null,{default:a(()=>[t(g,{modelValue:s.keyword,"onUpdate:modelValue":e[0]||(e[0]=l=>s.keyword=l),placeholder:"设备型号/名称",clearable:""},null,8,["modelValue"])]),_:1}),t(r,null,{default:a(()=>[t(B,{modelValue:s.warehouseId,"onUpdate:modelValue":e[1]||(e[1]=l=>s.warehouseId=l),placeholder:"选择仓库",clearable:""},{default:a(()=>[(b(),x(Q,null,S(w,l=>t(I,{key:l.id,label:l.name,value:l.id},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(r,null,{default:a(()=>[t(o,{type:"primary",onClick:_},{default:a(()=>e[13]||(e[13]=[p("搜索")])),_:1}),t(o,{onClick:E},{default:a(()=>e[14]||(e[14]=[p("重置")])),_:1})]),_:1})]),_:1},8,["model"])]),W((b(),X(P,{data:m.value,style:{width:"100%"}},{default:a(()=>[t(v,{prop:"modelNumber",label:"设备型号",width:"150"}),t(v,{prop:"deviceName",label:"设备名称",width:"180"}),t(v,{prop:"quantity",label:"设备数量",width:"100"},{default:a(({row:l})=>[y("span",{class:ee({"warning-text":l.quantity<=l.minQuantity})},Y(l.quantity),3)]),_:1}),t(v,{prop:"warehouseName",label:"所在仓库",width:"150"}),t(v,{prop:"location",label:"设备位置",width:"120"}),t(v,{label:"操作",width:"150",fixed:"right"},{default:a(({row:l})=>[t(o,{type:"primary",link:"",onClick:H=>$(l)},{default:a(()=>e[15]||(e[15]=[p("编辑")])),_:2},1032,["onClick"]),t(o,{type:"danger",link:"",onClick:H=>j(l)},{default:a(()=>e[16]||(e[16]=[p("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[G,h.value]]),y("div",ne,[t(R,{"current-page":V.value,"onUpdate:currentPage":e[2]||(e[2]=l=>V.value=l),"page-size":N.value,"onUpdate:pageSize":e[3]||(e[3]=l=>N.value=l),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:D.value,onSizeChange:O,onCurrentChange:L},null,8,["current-page","page-size","total"])]),t(Z,{title:k.value,modelValue:c.value,"onUpdate:modelValue":e[11]||(e[11]=l=>c.value=l),width:"500px",onClose:q},{footer:a(()=>[y("span",oe,[t(o,{onClick:e[10]||(e[10]=l=>c.value=!1)},{default:a(()=>e[17]||(e[17]=[p("取消")])),_:1}),t(o,{type:"primary",onClick:A},{default:a(()=>e[18]||(e[18]=[p("确定")])),_:1})])]),default:a(()=>[t(U,{ref_key:"formRef",ref:f,model:n,rules:F,"label-width":"100px"},{default:a(()=>[t(r,{label:"设备型号",prop:"modelNumber"},{default:a(()=>[t(g,{modelValue:n.modelNumber,"onUpdate:modelValue":e[4]||(e[4]=l=>n.modelNumber=l),placeholder:"请输入设备型号"},null,8,["modelValue"])]),_:1}),t(r,{label:"设备名称",prop:"deviceName"},{default:a(()=>[t(g,{modelValue:n.deviceName,"onUpdate:modelValue":e[5]||(e[5]=l=>n.deviceName=l),placeholder:"请输入设备名称"},null,8,["modelValue"])]),_:1}),t(r,{label:"设备数量",prop:"quantity"},{default:a(()=>[t(z,{modelValue:n.quantity,"onUpdate:modelValue":e[6]||(e[6]=l=>n.quantity=l),min:0,precision:0,placeholder:"请输入设备数量"},null,8,["modelValue"])]),_:1}),t(r,{label:"最小库存",prop:"minQuantity"},{default:a(()=>[t(z,{modelValue:n.minQuantity,"onUpdate:modelValue":e[7]||(e[7]=l=>n.minQuantity=l),min:0,precision:0,placeholder:"请输入最小库存数量"},null,8,["modelValue"])]),_:1}),t(r,{label:"所在仓库",prop:"warehouseId"},{default:a(()=>[t(B,{modelValue:n.warehouseId,"onUpdate:modelValue":e[8]||(e[8]=l=>n.warehouseId=l),placeholder:"请选择仓库",style:{width:"100%"}},{default:a(()=>[(b(),x(Q,null,S(w,l=>t(I,{key:l.id,label:l.name,value:l.id},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"设备位置",prop:"location"},{default:a(()=>[t(g,{modelValue:n.location,"onUpdate:modelValue":e[9]||(e[9]=l=>n.location=l),placeholder:"请输入设备位置（如：B-1-2）"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}},se=J(ue,[["__scopeId","data-v-0e21cc47"]]);export{se as default};
